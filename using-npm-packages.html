<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <!-- Basic -->
    <title>Using npm Packages | Meteor Guide</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="../images/favicon.png" sizes="16x16 32x32 64x64">

    <!-- Social -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="http://meteor.realgrid.com">
    <meta property="og:title" content="Using npm Packages | Meteor Guide">
    <meta property="og:description" content="">
    <meta property="og:image" content="">
    <meta name="twitter:card" content="summary_image_large">
    <meta name="twitter:site" content="@meteor">
    <meta name="twitter:title" content="Using npm Packages | Meteor Guide">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="">

    <!-- Misc -->
    <meta name="google-site-verification" content="" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,300italic,400italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/style/style.css">
  </head>
  <body class="">
    

<div class="nav dark">
  <div class="nav-group">
    <div class="nav-item show-mobile">
      <span class="js-sidebar-toggle ">
        <span class="icon-menu"></span>
      </span>
    </div>
    <div class="nav-item">
      <a class="logo-wrapper" href="http://www.meteor.com/developers" title="Meteor Developers Developers"  >
        <img src="../images/logo-coralspace-left.svg" alt="Meteor Developers" class="logo"/>
        <span>Developers</span>
      </a>
    </div>
  </div>

  <div class="nav-group right">
    
      <div class="nav-item show-desktop  ">
        <a class="link" href="http://www.meteor.com/tutorials" target=_new >
          <span>Tutorials</span>
        </a>
      </div>
    
      <div class="nav-item show-desktop active ">
        <a class="link" href="http://guide.meteor.com"  >
          <span>Guide</span>
        </a>
      </div>
    
      <div class="nav-item show-desktop  ">
        <a class="link" href="http://docs.meteor.com"  >
          <span>API Docs</span>
        </a>
      </div>
    
      <div class="nav-item show-desktop  ">
        <a class="link" href="https://forums.meteor.com/" target=_new >
          <span>Forums</span>
        </a>
      </div>
    
  </div>
</div>

<div class="sidebar">
  <div class="panel">
    <div class="panel-item">
      <a class="" href="http://www.meteor.com/developers" title="Meteor Developers"  >
        <span>Meteor Developers Developers</span>
      </a>
    </div>
    
      <div class="panel-item "">
        <a class="" href="http://www.meteor.com/tutorials" target=_new >
          <span>Tutorials</span>
        </a>
      </div>
    
      <div class="panel-item active"">
        <a class="" href="http://guide.meteor.com"  >
          <span>Guide</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="http://docs.meteor.com"  >
          <span>API Docs</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="https://forums.meteor.com/" target=_new >
          <span>Forums</span>
        </a>
      </div>
    
  </div>

  <div class="sidebar-content">
    <div class="topcap">
      <span class="title-sidebar">Meteor Guide</span>
      
        <span class="select version-sidebar nochrome">
          <select class="version-select">
            
              <option value="v1.4">1.4</option>
            
              <option value="v1.3">1.3</option>
            
              <option value="v1.2">1.2</option>
            
          </select>
        </span>
      
    </div>

    
    <div class="wrapper-search">
      <div class="input-symbol small round">
        <input type="text" placeholder="Search The Official Guide" id="desktop-search-input" />
        <span class="icon-search"></span>
      </div>
      <div class="wrapper-desktop-search-results"></div>
    </div>

    

    <ul class="toc">
      
        <li>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="index.html" class="sidebar-link ">
                  <span>Introduction</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="code-style.html" class="sidebar-link ">
                  <span>Code Style</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="structure.html" class="sidebar-link ">
                  <span>Application Structure</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="1.4-migration.html" class="sidebar-link ">
                  <span>Migrating to Meteor 1.4</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="1.3-migration.html" class="sidebar-link ">
                  <span>Migrating to Meteor 1.3</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Data</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="collections.html" class="sidebar-link ">
                  <span>Collections and Schemas</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="data-loading.html" class="sidebar-link ">
                  <span>Publications and Data Loading</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="methods.html" class="sidebar-link ">
                  <span>Methods</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="accounts.html" class="sidebar-link ">
                  <span>Users and Accounts</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="testing.html" class="sidebar-link ">
                  <span>Testing</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">View</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="routing.html" class="sidebar-link ">
                  <span>URLs and Routing</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="ui-ux.html" class="sidebar-link ">
                  <span>User Interfaces</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="blaze.html" class="sidebar-link ">
                  <span>Blaze</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="react.html" class="sidebar-link ">
                  <span>React</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="angular.html" class="sidebar-link ">
                  <span>Angular</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Build</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="atmosphere-vs-npm.html" class="sidebar-link ">
                  <span>Atmosphere vs. npm</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="using-atmosphere-packages.html" class="sidebar-link ">
                  <span>Using Atmosphere Packages</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="writing-atmosphere-packages.html" class="sidebar-link ">
                  <span>Writing Atmosphere Packages</span>
                </a>
              </li>
            
              
              <li class="item-toc  current">
                <a href="" class="sidebar-link  current">
                  <span>Using npm Packages</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="writing-npm-packages.html" class="sidebar-link ">
                  <span>Writing npm Packages</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="mobile.html" class="sidebar-link ">
                  <span>Mobile</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="build-tool.html" class="sidebar-link ">
                  <span>Build System</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Production</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="security.html" class="sidebar-link ">
                  <span>Security</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="deployment.html" class="sidebar-link ">
                  <span>Deployment and Monitoring</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Meta</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="CONTRIBUTING.html" class="sidebar-link ">
                  <span>Contribution Guidelines</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="CHANGELOG.html" class="sidebar-link ">
                  <span>Changelog</span>
                </a>
              </li>
            
          </ul>
        </li>
      
    </ul>
  </div>
</div>

<div class="content">
  <div class="content-wrapper">
    <div class="header-content">
      <h1 class="title-page">Using npm Packages</h1>
      

      <div class="page-actions">
        <div class="actions-group">
          <a class="btn tertiary small round lowercase" href="https://github.com/meteor/guide/tree/master/content/using-npm-packages.md" target="_blank"><span class="icon-github"></span> <span>Edit on GitHub</span></a>
          
            <a class="btn tertiary small round lowercase" href="https://forums.meteor.com/t/20193"><span class="icon-comment"></span> <span>Discuss</span></a>
          
        </div>
      </div>
    </div>

    <div class="document-formatting">
      <h2 id="npm-searching">Searching for packages</h2>

<p>You can use the official search at <a href="https://www.npmjs.com/" target="_blank" rel="external">npmjs.com</a> or see results sorted by package quality (code quality, maintenance status, development velocity, popularity etc.) at <a href="https://npms.io/" target="_blank" rel="external">npms.io</a>. There are also sites that search certain types of packages, like <a href="https://js.coach/" target="_blank" rel="external">js.coach</a>‘s <a href="https://js.coach/react" target="_blank" rel="external">React</a> and <a href="https://js.coach/react-native" target="_blank" rel="external">React Native</a> sections.</p>
<h2 id="client-npm">npm on the client</h2>

<p>Tools like <a href="http://browserify.org" target="_blank" rel="external">browserify</a> and <a href="https://webpack.github.io" target="_blank" rel="external">webpack</a> are designed to provide a Node-like environment on the client so that many npm packages, even ones originally intended for the server, can run unmodified. Meteor’s ES2015 module system does this for you out of the box with no additional configuration necessary. In most cases, you can simply import npm dependencies from a client file, just as you would on the server.</p>
<blockquote>
<p>When creating a new application Meteor installs the <code>meteor-node-stubs</code> npm package to help provide this client browser compatibility. If you are upgrading an application to Meteor 1.3 you may have to run <code>meteor npm install --save meteor-node-stubs</code> manually.</p>
</blockquote>
<h2 id="installing-npm">Installing npm Packages</h2>

<p>npm packages are configured in a <code>package.json</code> file at the root of your project. If you create a new Meteor project, you will have such a file created for you. If not you can run <code>meteor npm init</code> to create one.</p>
<p>To install a package into your app you run the <code>npm install</code> command with the <code>--save</code> flag:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meteor npm install --save moment</span><br></pre></td></tr></table></figure>
<p>This will both update your <code>package.json</code> with information about the dependency and download the package into your app’s local <code>node_modules/</code> directory. Typically, you don’t check the <code>node_modules/</code> directory into source control and your teammates run <code>meteor npm install</code> to get up to date when dependencies change:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meteor npm install</span><br></pre></td></tr></table></figure>
<p>If the package is just a development dependency (i.e. it’s used for testing, linting or the like) then you should use <code>--save-dev</code>. That way if you have some kind of build script, it can do <code>npm install --production</code> and avoid installing packages it doesn’t need.</p>
<p>For more information about <code>npm install</code>, check out the <a href="https://docs.npmjs.com/getting-started/installing-npm-packages-locally" target="_blank" rel="external">official documentation</a>.</p>
<blockquote>
<p>Meteor comes with npm bundled so that you can type <code>meteor npm</code> without worrying about installing it yourself. If you like, you can also use a globally installed npm to manage your packages.</p>
</blockquote>
<h2 id="using-npm">Using npm Packages</h2>

<p>To use an npm package from a file in your application you simply <code>import</code> the name of the package:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">'moment'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// this is equivalent to the standard node require:</span></span><br><span class="line"><span class="keyword">const</span> moment = <span class="built_in">require</span>(<span class="string">'moment'</span>);</span><br></pre></td></tr></table></figure>
<p>This imports the default export from the package into the symbol <code>moment</code>.</p>
<p>You can also import specific functions from a package using the destructuring syntax:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; isArray &#125; <span class="keyword">from</span> <span class="string">'lodash'</span>;</span><br></pre></td></tr></table></figure>
<p>You can also import other files or JS entry points from a package:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; parse &#125; <span class="keyword">from</span> <span class="string">'graphql/language'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="npm-styles">Importing styles from npm</h3>

<p>Using any of Meteor’s <a href="build-tool.html#css">supported CSS pre-processors</a> you can import other style files provided by an NPM into your application using both relative and absolute paths.  However, this will only work for the top-level app and will not work inside an Atmosphere package.</p>
<p>Importing styles from an npm package with an absolute path using the <code>{}</code> syntax, for instance with Less:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">'&#123;&#125;/node_modules/npm-package-name/button.less'</span>;</span><br></pre></td></tr></table></figure>
<p>Importing styles from an npm package with a relative path:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">'../../node_modules/npm-package-name/colors.less'</span>;</span><br></pre></td></tr></table></figure>
<p>You can also import CSS directly from a JavaScript file to control load order if you have the <code>ecmascript</code> package installed:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'npm-package-name/stylesheets/styles.css'</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>When importing CSS from a JavaScript file, that CSS is not bundled with the rest of the CSS processed with the Meteor Build tool, but instead is put in your app’s <code>&lt;head&gt;</code> tag inside <code>&lt;style&gt;...&lt;/style&gt;</code> after the main concatenated CSS file.</p>
</blockquote>
<h2 id="npm-shrinkwrap">npm Shrinkwrap</h2>

<p><code>package.json</code> typically encodes a version range, and so each <code>npm install</code> command can sometimes lead to a different result if new versions have been published in the meantime. In order to ensure that you and the rest of your team are using the same exact same version of each package, it’s a good idea to use <code>npm shrinkwrap</code> after making any dependency changes to <code>package.json</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># after installing</span></span><br><span class="line">meteor npm install --save moment</span><br><span class="line">meteor npm shrinkwrap</span><br></pre></td></tr></table></figure>
<p>This will create an <code>npm-shrinkwrap.json</code> file containing the exact versions of each dependency, and you should check this file into source control. For even more precision (the contents of a given version of a package <em>can</em> change), and to avoid a reliance on the npm server during deployment, you should consider using <a href="#npm-shrinkpack"><code>npm shrinkpack</code></a>.</p>
<h2 id="async-callbacks">Asyncronous Callbacks</h2>

<p>Many npm packages rely on an asynchronous, callback or promise-based coding style. For several reasons, Meteor is currently built around a synchronous-looking but still non-blocking style using <a href="https://github.com/laverdet/node-fibers" target="_blank" rel="external">Fibers</a>.</p>
<p>The global Meteor server context and every method and publication initialize a new fiber so that they can run concurrently. Many Meteor APIs, for example collections, rely on running inside a fiber. They also rely on an internal Meteor mechanism that tracks server “environment” state, like the currently executing method. This means you need to initialize your own fiber and environment to use asynchronous Node code inside a Meteor app. Let’s look at an example of some code that won’t work, using the code example from the <a href="https://github.com/mikedeboer/node-github" target="_blank" rel="external">node-github repository</a>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Inside a Meteor method definition</span></span><br><span class="line">updateGitHubFollowers() &#123;</span><br><span class="line">  github.user.getFollowingFromUser(&#123;</span><br><span class="line">    <span class="attr">user</span>: <span class="string">'stubailo'</span></span><br><span class="line">  &#125;, (err, res) =&gt; &#123;</span><br><span class="line">    <span class="comment">// Using a collection here will throw an error</span></span><br><span class="line">    <span class="comment">// because the asynchronous code is not in a fiber</span></span><br><span class="line">    Followers.insert(res);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Let’s look at a few ways to resolve this issue.</p>
<h3 id="bind-environment"><code>Meteor.bindEnvironment</code></h3>

<p>In most cases, simply wrapping the callback in <code>Meteor.bindEnvironment</code> will do the trick. This function both wraps the callback in a fiber, and does some work to maintain Meteor’s server-side environment tracking. Here’s the same code with <code>Meteor.bindEnvironment</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Inside a Meteor method definition</span></span><br><span class="line">updateGitHubFollowers() &#123;</span><br><span class="line">  github.user.getFollowingFromUser(&#123;</span><br><span class="line">    <span class="attr">user</span>: <span class="string">'stubailo'</span></span><br><span class="line">  &#125;, Meteor.bindEnvironment(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Everything is good now</span></span><br><span class="line">    Followers.insert(res);</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>However, this won’t work in all cases - since the code runs asynchronously, we can’t use anything we got from an API in the method return value. We need a different approach that will convert the async API to a synchronous-looking one that will allow us to return a value.</p>
<h3 id="wrap-async"><code>Meteor.wrapAsync</code></h3>

<p>Many npm packages adopt the convention of taking a callback that accepts <code>(err, res)</code> arguments. If your asynchronous function fits this description, like the one above, you can use <code>Meteor.wrapAsync</code> to convert to a fiberized API that uses return values and exceptions instead of callbacks, like so:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Setup sync API</span></span><br><span class="line"><span class="keyword">const</span> getFollowingFromUserFiber =</span><br><span class="line">  Meteor.wrapAsync(github.user.getFollowingFromUser, github.user);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Inside a Meteor method definition</span></span><br><span class="line">updateGitHubFollowers() &#123;</span><br><span class="line">  <span class="keyword">const</span> res = getFollowingFromUserFiber(&#123;</span><br><span class="line">    <span class="attr">user</span>: <span class="string">'stubailo'</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  Followers.insert(res);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Return how many followers we have</span></span><br><span class="line">  <span class="keyword">return</span> res.length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If you wanted to refactor this and create a completely fiber-wrapper GitHub client, you could write some logic to loop over all of the methods available and call <code>Meteor.wrapAsync</code> on them, creating a new object with the same shape but with a more Meteor-compatible API.</p>
<h3 id="promises">Promises</h3>

<p>Recently, a lot of npm packages have been moving to Promises instead of callbacks for their API. This means you actually get a return value from the asynchronous function, but it’s just an empty shell where the real value is filled in later.</p>
<p>The good news is that Promises can be used with the new ES2015 <code>async/await</code> syntax (available in the <code>ecmascript</code> package since Meteor 1.3) in a natural and synchronous-looking style on both the client and the server.</p>
<p>If you declare your function <code>async</code> (which ends up meaning it returns a Promise itself), then you can use the <code>await</code> keyword to wait on other promise inside. This makes it very easy to serially call Promise-based libraries:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">sendTextMessage</span>(<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> toNumber = <span class="keyword">await</span> phoneLookup.findFromEmail(user.emails[<span class="number">0</span>].address);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> client.sendMessage(&#123;</span><br><span class="line">    <span class="attr">to</span>: toNumber,</span><br><span class="line">    <span class="attr">from</span>: <span class="string">'+14506667788'</span>,</span><br><span class="line">    <span class="attr">body</span>: <span class="string">'Hello world!'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="npm-shrinkpack">Shrinkpack</h2>

<p><a href="https://github.com/JamieMason/shrinkpack" target="_blank" rel="external">Shrinkpack</a> is a tool that gives you more bulletproof and repeatable builds than you get by using <a href="#npm-shrinkwrap"><code>npm shrinkwrap</code></a> alone.</p>
<p>Essentially it copies a tarball of the contents of each of your npm dependencies into your application source repository. This is essentially a more robust version of the <code>npm-shrinkwrap.json</code> file that shrinkwrap creates, because it means your application’s npm dependencies can be assembled without the need or reliance on the npm servers being available or reliable. This is good for repeatable builds especially when deploying.</p>
<p>To use shrinkpack, first globally install it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g shrinkpack</span><br></pre></td></tr></table></figure>
<p>Then use it directly after you shrinkwrap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">meteor npm install --save moment</span><br><span class="line">meteor npm shrinkwrap</span><br><span class="line">shrinkpack</span><br></pre></td></tr></table></figure>
<p>You should then check the generated <code>node_shrinkwrap/</code> directory into source control, but ensure it is ignored by your text editor.</p>
<p><strong>NOTE</strong>: Although this is a good idea for projects with a lot of npm dependencies, it will not affect Atmosphere dependencies, even if they themselves have direct npm dependencies.</p>

    </div>
  </div>

  <div class="pagination">
    <div class="content-wrapper">
      
      
        <a class="link primary prev"
          href="writing-atmosphere-packages.html">
          <span class="icon-arrow-left-alt"></span>
          <span class="subtitle-pagination">Previous</span>
          Writing Atmosphere Packages
        </a>
      
      
        <a class="link primary next"
          href="writing-npm-packages.html">
          <span class="subtitle-pagination">Next</span>
          Writing npm Packages
          <span class="icon-arrow-right-alt"></span>
        </a>
      
    </div>
  </div>

  <div class="github">
    <a class="link tertiary " href="https://github.com/meteor/guide/tree/master/content/using-npm-packages.md" target="_blank">
      <span class="icon-github"></span>Edit on GitHub</a>
  </div>

  
    <div class="discourse-comments-wrapper content-wrapper">
      <div id='discourse-comments'></div>
    </div>

    <script type="text/javascript">
      DiscourseEmbed = { discourseUrl: 'https://forums.meteor.com/',
                         topicId: 20193 };

      (function() {
        var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
        d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
      })();
    </script>
  
</div>

    <script src="/script/smooth-scroll.min.js"></script>
    <script src="/script/main.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/2.1.8/docsearch.min.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

    <script>
      // nectar ninja
      (function(){
        var handle = '@meteorjs';
        var a = document.createElement('script');
        var m = document.getElementsByTagName('script')[0];
        a.async = 1;
        a.src = 'https://nectar.ninja/api/v1/' + handle.slice(1);
        m.parentNode.insertBefore(a, m);
      })();

     
      
        // Segment Tracking
        !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
        analytics.load("zQx6cQifkTU79E3L0XAnmrOXP2A5bC6r");
        analytics.page()
        }}();
      

      // search box
      

        ['desktop'].forEach(function(type) {
          var search = docsearch({
            apiKey: 'bdf6b09d12024f6bae3631a0dfdd4a7f',
            indexName: 'meteor_api_guide',
            inputSelector: '#' + type + '-search-input',
            autocompleteOptions: {
              dropdownMenuContainer: '.wrapper-' + type + '-search-results',
              debug: true
            },
            algoliaOptions: {
              hitsPerPage: 20
            }
          }).autocomplete;

          var sidebar = document.querySelector('.sidebar-content');
          search.on('autocomplete:opened', function() {
            sidebar.classList.add('searching');
          });
          search.on('autocomplete:closed', function() {
            sidebar.classList.remove('searching');
          });
          search.on('autocomplete:updated', function() {
            if (search.val() === '') {
              search.autocomplete.close();
            }
          });
        });
      

      
        var REDIRECTS = {
  "/using-packages.html": "atmosphere-vs-npm.html",
  "/using-packages.html#npm": "using-npm-packages.html",
  "/using-packages.html#client-npm": "using-npm-packages.html#client-npm",
  "/using-packages.html#installing-npm": "using-npm-packages.html#installing-npm",
  "/using-packages.html#using-npm": "using-npm-packages.html#using-npm",
  "/using-packages.html#npm-styles": "using-npm-packages.html#npm-styles",
  "/using-packages.html#npm-shrinkwrap": "using-npm-packages.html#npm-shrinkwrap",
  "/using-packages.html#atmosphere": "using-atmosphere-packages.html",
  "/using-packages.html#atmosphere-searching": "using-atmosphere-packages.html#atmosphere-searching",
  "/using-packages.html#atmosphere-naming": "using-atmosphere-packages.html#atmosphere-naming",
  "/using-packages.html#installing-atmosphere": "using-atmosphere-packages.html#installing-atmosphere",
  "/using-packages.html#using-atmosphere": "using-atmosphere-packages.html#using-atmosphere",
  "/using-packages.html#importing-atmosphere-styles": "using-atmosphere-packages.html#importing-atmosphere-styles",
  "/using-packages.html#peer-npm-dependencies": "using-atmosphere-packages.html#peer-npm-dependencies",
  "/using-packages.html#package-namespacing": "using-atmosphere-packages.html#package-namespacing",
  "/using-packages.html#async-callbacks": "using-npm-packages.html#async-callbacks",
  "/using-packages.html#bind-environment": "using-npm-packages.html#bind-environment",
  "/using-packages.html#wrap-async": "using-npm-packages.html#wrap-async",
  "/using-packages.html#promises": "using-npm-packages.html#promises",
  "/using-packages.html#overriding-packages": "writing-npm-packages.html#overriding-npm-packages",
  "/using-packages.html#npm-overriding": "writing-npm-packages.html#overriding-npm-packages",
  "/using-packages.html#atmosphere-overriding": "writing-atmosphere-packages.html#overriding-atmosphere-packages",
  "/using-packages.html#npm-shrinkpack": "using-npm-packages.html#npm-shrinkpack",
  "/writing-packages.html": "writing-atmosphere-packages.html",
  "/writing-packages.html#npm-vs-atmosphere": "atmosphere-vs-npm.html",
  "/writing-packages.html#creating-npm": "writing-npm-packages.html",
  "/writing-packages.html#including-in-app": "writing-npm-packages.html#including-in-app",
  "/writing-packages.html#publishing-npm": "writing--packages.html#publishing-npm",
  "/writing-packages.html#creating": "writing-atmosphere-packages.html",
  "/writing-packages.html#adding-files": "writing-atmosphere-packages.html#adding-files",
  "/writing-packages.html#adding-javascript": "writing-atmosphere-packages.html#adding-javascript",
  "/writing-packages.html#adding-css": "writing-atmosphere-packages.html#adding-css",
  "/writing-packages.html#adding-style": "writing-atmosphere-packages.html#adding-style",
  "/writing-packages.html#adding-assests": "writing-atmosphere-packages.html#adding-assets",
  "/writing-packages.html#exporting": "writing-atmosphere-packages.html#exporting",
  "/writing-packages.html#dependencies": "writing-atmosphere-packages.html#dependencies",
  "/writing-packages.html#atmosphere-dependencies": "writing-atmosphere--packages.html#atmosphere-dependencies",
  "/writing-packages.html#meteor-version-dependencies": "writing-atmosphere-packages.html#meteor-version-dependencies",
  "/writing-packages.html#version-constraints": "writing-atmosphere-packages.html#version-constraints",
  "/writing-packages.html#npm-dependencies": "writing-atmosphere-packages.html#npm-dependencies",
  "/writing-packages.html#peer-npm-dependencies": "writing-atmosphere-packages.html#peer-npm-dependencies",
  "/writing-packages.html#cordova-plugins": "writing-atmosphere-packages.html#cordova-plugins",
  "/writing-packages.html#testing": "writing-atmosphere-packages.html#testing",
  "/writing-packages.html#testing-with-peer-dependencies": "writing-atmosphere-packages.html#testing-with-peer-dependencies",
  "/writing-packages.html#local-vs-published": "writing-atmosphere-packages.html#local-vs-published",
  "/writing-packages.html#build-plugins": "build-tool.html#build-plugins",
  "/writing-packages.html#types-of-build-plugins": "build-tool.html#types-of-build-plugins",
  "/writing-packages.html#writing-build-plugins": "build-tool.html#writing-build-plugins",
  "/writing-packages.html#caching-build-plugins": "build-tool.html#caching-build-plugins",
  "/testing.html#simple-unit-test": "testing.html#simple-blaze-unit-test"
};

        function redirect() {
          // Support redirects of the form /path#hash
          var locationKey = location.pathname + location.hash;
          if (REDIRECTS[locationKey]) {
            location.replace(location.origin + '/' + REDIRECTS[locationKey]);
          }

          // Support redirects of the form #hash (works for any path)
          var hashKey = location.hash;
          if (REDIRECTS[hashKey]) {
            location.replace(location.origin + '/' + REDIRECTS[hashKey]);
          }
        }

        // Redirect now
        redirect();

        // Redirect on hash change
        window.onhashchange = redirect;
      
    </script>
  </body>
</html>
